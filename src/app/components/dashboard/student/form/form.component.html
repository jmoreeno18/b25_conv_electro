<!-- Instrucciones -->
<div class="max-w-4xl mx-auto p-4 mb-6 px-4 sm:px-6 sm:p-6 bg-white rounded-2xl shadow-sm">
  <h2 class="text-3xl font-bold text-[#002782] mb-4">Instrucciones para subir la documentación</h2>
  <ul class="space-y-3 text-gray-700 text-sm sm:text-base">
    <li class="flex items-start gap-2">
      <span class="mt-1 text-[#002782]">
        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
          <path
            d="M16.707 5.293a1 1 0 00-1.414 0L9 11.586 6.707 9.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l7-7a1 1 0 000-1.414z" />
        </svg>
      </span>
      Selecciona un tipo de titulación: Certificado Profesional o Titulación Académica Reglada
    </li>
    <li class="flex items-start gap-2">
      <span class="mt-1 text-[#002782]">
        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
          <path d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h5v-2H4V5h12v3h2V5a2 2 0 00-2-2H4z" />
          <path d="M14 11v2h-4v2h4v2l3-3-3-3z" />
        </svg>
      </span>
      Sube tus documentos en formato <strong>PDF</strong>, <strong>PNG</strong> o <strong>JPG</strong>
    </li>
    <li class="flex items-start gap-2">
      <span class="mt-1 text-[#002782]">
        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
          <path d="M2 5a2 2 0 012-2h12a2 2 0 012 2v.5a.5.5 0 01-.5.5h-15a.5.5 0 01-.5-.5V5z" />
          <path d="M4 8h12v2H4V8zm0 4h12v2H4v-2z" />
        </svg>
      </span>
      Asegúrate de que los títulos adjuntos sean claros y estén completos y no tengan acentos ni ningún caracter especial.
    </li>
    <li class="flex items-start gap-2">
      <span class="mt-1 text-[#002782]">
        <svg class="w-5 h-5 text-[#002782]" fill="currentColor" viewBox="0 0 20 20">
          <path
            d="M4 3a2 2 0 012-2h6.586a2 2 0 011.414.586l3.414 3.414A2 2 0 0118 6.414V17a2 2 0 01-2 2H6a2 2 0 01-2-2V3z" />
        </svg>
      </span>
      Para mantener un formato uniforme, nombra tus archivos así:
    </li>
  </ul>
  <p class="mt-4 text-gray-700 leading-relaxed text-sm sm:text-base">
    <span class="block font-semibold text-[#FF5B41]">Apellido1_Apellido2_Nombre_Certificado_Año</span>
    <br />
    Ejemplo:
    <code class="bg-gray-100 px-2 py-1 rounded-md">Garcia_Lopez_Marta_TituloDietetica_2023.pdf</code>
  </p>
</div>

<!-- Formulario -->
<div class="max-w-4xl mx-auto px-4 sm:px-6 p-6 rounded-2xl shadow-md bg-[#EDEDED]">
  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="space-y-4" novalidate>

    <!-- Tipo de Titulación -->
    <div>
      <label class="block font-semibold mb-2">Tipo de titulación</label>
      <div class="relative">
        <select formControlName="tipoTitulacion" [ngClass]="{
              'border-red-500': form.get('tipoTitulacion')?.touched && form.get('tipoTitulacion')?.invalid,
              'border-green-500': form.get('tipoTitulacion')?.touched && form.get('tipoTitulacion')?.valid,
              'border-gray-300': !form.get('tipoTitulacion')?.touched
            }" class="w-full appearance-none rounded-xl bg-white border p-3 pr-12 text-gray-700
                   focus:outline-none focus:border-[#FF5B41] focus:shadow-md focus:shadow-[#FF5B41]/20
                   peer transition-all duration-200 cursor-pointer">
          <option disabled value="">Selecciona una opción</option>
          <option value="certificado">Certificado Profesional</option>
          <option value="reglada">Titulación Académica Reglada</option>
        </select>
        <div class="pointer-events-none absolute right-4 top-1/2 -translate-y-1/2 text-[#002782]
                      peer-focus:text-[#FF5B41] transition-all">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd"
              d="M5.23 7.21a.75.75 0 011.06.02L10 10.94l3.71-3.7a.75.75 0 111.06 1.06l-4.24 4.24a.75.75 0 01-1.06 0L5.25 8.29a.75.75 0 01-.02-1.06z"
              clip-rule="evenodd" />
          </svg>
        </div>
      </div>
      <div *ngIf="form.get('tipoTitulacion')?.touched && form.get('tipoTitulacion')?.invalid"
        class="text-red-600 text-sm mt-1">
        Campo obligatorio
      </div>
    </div>

    <!-- Título académico -->
    <div>
      <label class="block font-semibold mb-2">Nombre de la titulación/certificado</label>
      <input type="text" formControlName="titulo" placeholder="Ej. Grado en Dietética" [ngClass]="{
            'border-red-500': form.get('titulo')?.touched && form.get('titulo')?.invalid,
            'border-green-500': form.get('titulo')?.touched && form.get('titulo')?.valid,
            'border-gray-300': !form.get('titulo')?.touched
          }" class="w-full rounded-xl bg-white border p-3 placeholder-gray-400
                 focus:outline-none focus:border-[#FF5B41] focus:shadow-md focus:shadow-[#FF5B41]/20
                 transition-all duration-200" />
      <div *ngIf="form.get('titulo')?.touched && form.get('titulo')?.invalid" class="text-red-600 text-sm mt-1">
        Campo obligatorio
      </div>
    </div>

<!-- Experiencia laboral (opcional) -->
<div>
  <label class="block font-semibold mb-2">Experiencia laboral</label>
  <textarea
    formControlName="experiencia"
    [ngClass]="{
      'border-green-500': form.get('experiencia')?.dirty && form.get('experiencia')?.value?.trim() !== '',
      'border-gray-300': form.get('experiencia')?.value?.trim() === ''
    }"
    rows="4"
    class="w-full rounded-xl bg-white border p-3 placeholder-gray-400
           focus:outline-none focus:border-[#FF5B41] focus:shadow-md focus:shadow-[#FF5B41]/20
           transition-all duration-200 resize-none"
    placeholder="Describe brevemente tu experiencia"
  ></textarea>
</div>

    <!-- Subida de archivos -->
    <div>
      <label class="block font-semibold mb-2">Documentos (PDF, etc.)</label>
      <input #fileInput type="file" (change)="onFileChange($event)" [ngClass]="{
            'border-red-500': form.get('documentos')?.touched && form.get('documentos')?.invalid,
            'border-green-500': form.get('documentos')?.touched && form.get('documentos')?.valid,
            'border-gray-300': !form.get('documentos')?.touched
          }" class="file-input w-full bg-white border
                 file:bg-[#FF5B41] file:text-white file:font-semibold file:px-4 file:py-2
                 file:border-0 hover:file:bg-[#ff7762]
                 focus:outline-none focus:border-[#FF5B41] transition-all duration-200" />
      <div *ngIf="form.get('documentos')?.touched && form.get('documentos')?.invalid" class="text-red-600 text-sm mt-1">
        Debes subir al menos un archivo
      </div>
    </div>

    <!-- Botones -->
    <div class="flex flex-col sm:flex-row justify-end gap-4 mt-6">
      <button type="button" (click)="resetForm()"
        class="btn px-8 py-3 text-base bg-gray-300 hover:bg-gray-200 text-black rounded-full w-full sm:w-auto">
        Limpiar
      </button>
      <button type="submit"
        class="btn px-8 py-3 text-base bg-[#002782] hover:bg-[#FF5B41] text-white rounded-full w-full sm:w-auto">
        Enviar
      </button>
    </div>
  </form>
  <div *ngIf="successMessage" class="bg-green-100 border-l-4 mt-4 border-green-500 text-green-700 p-4 rounded-xl mb-4">
    ✅ Tu solicitud se ha enviado correctamente.
  </div>
</div>

<!-- Documentos ya subidos -->
<div class="max-w-4xl mx-auto px-4 sm:px-6 mt-8 p-6 rounded-2xl shadow-md bg-[#EDEDED]">
  <h3 class="text-2xl font-bold text-[#002782] mb-4">Documentación enviada</h3>

  <!-- Mostrar spinner primero -->
  <ng-container *ngIf="loading; else contenidoDocs">
    <div class="flex justify-center items-center py-6">
      <span class="loading loading-spinner loading-lg text-[#002782]"></span>
    </div>
  </ng-container>

  <!-- Contenido si no está cargando -->
  <ng-template #contenidoDocs>
    <ng-container *ngIf="uploadedDocs.length > 0; else noDocs">
      <ul class="space-y-3">
        <li *ngFor="let doc of uploadedDocs"
            class="flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 p-4 bg-white rounded-xl shadow-sm">
          <div class="flex items-center gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-[#002782]" viewBox="0 0 20 20" fill="currentColor">
              <path d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h5v-2H4V5h12v3h2V5a2 2 0 00-2-2H4z" />
              <path d="M14 11v2h-4v2h4v2l3-3-3-3z" />
            </svg>
            <span class="text-gray-800 font-medium text-sm sm:text-base">
              {{ doc.nombre_archivo || 'Sin nombre' }}
            </span>
          </div>
          <button (click)="downloadFile(doc)"
            class="btn px-8 py-3 text-base bg-[#002782] text-white hover:bg-[#FF5B41] rounded-full transition-all w-full sm:w-auto text-center">
            Descargar
          </button>
        </li>
      </ul>
    </ng-container>

    <!-- No hay documentos -->
    <ng-template #noDocs>
      <p class="text-gray-500 text-sm">No tienes ningún documento subido.</p>
    </ng-template>
  </ng-template>
</div>


